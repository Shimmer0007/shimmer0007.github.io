<style>
    .ug-center-text { text-align: center; }
    .ug-grid-2 { display: grid; grid-template-columns: repeat(2, 1fr); gap: 2rem; align-items: center; }
    .ug-info-card { background: var(--input-bg); padding: 2rem; border-radius: var(--border-radius-main); }
    .ug-score-box { padding: 1rem; border-radius: var(--border-radius-small); margin-bottom: 1rem; }
    .ug-score-box-green { background-color: color-mix(in srgb, var(--success-green) 15%, transparent); }
    .ug-score-box-blue { background-color: color-mix(in srgb, var(--primary-accent) 15%, transparent); }
    .ug-score-title { font-weight: bold; font-size: 1.1em; }
    .ug-score-number { font-size: 2.5rem; font-weight: bold; letter-spacing: -0.05em; }
    .ug-code-block { background-color: #1F2937; border: 1px solid #374151; border-radius: 0.75rem; padding: 1.5rem; margin-top: 1.5rem; font-size: 0.875rem; line-height: 1.6; overflow-x: auto; }
    .ug-text-red { color: #f87171; }
    .ug-text-green { color: #4ade80; }
    .ug-text-blue { color: #60a5fa; }
    .ug-text-yellow { color: #facc15; }
    .ug-text-purple { color: #c084fc; }
    .ug-text-teal { color: #5eead4; }

    /* å“åº”å¼è°ƒæ•´ */
    @media (max-width: 768px) {
        .ug-grid-2 { grid-template-columns: 1fr; }
    }
</style>

<div class="ug-center-text">
    <h1 class="text-5xl md:text-6xl font-bold mb-4 leading-tight" style="font-size: 2.5em; margin-bottom: 1rem;">è™šå‡ç¹è£ä¹‹ä¸‹</h1>
    <p class="text-2xl text-gray-400 mt-6" style="font-size: 1.5em; color: var(--text-medium);">â€”â€”å¤ç›˜æ•°æ®æ³„éœ²ä¸æ¨¡å‹è¯„ä¼°</p>
    <p class="text-2xl text-gray-400 mt-6" style="font-size: 1.5em; color: var(--text-medium);">Datawhale AIå¤ä»¤è¥ 2025 I</p>
</div>

<h2 id="s2-baseline">èµ·ç‚¹ï¼šå¤ä»¤è¥çš„Baseline (0.637åˆ†)</h2>
<p>æ‰“å¡å®ŒTask1å†å›è¿‡å¤´æ¥çœ‹æˆ‘ä»¬çš„baselineï¼Œå®ƒçš„ç‰¹å¾å·¥ç¨‹éå¸¸åŸºç¡€ï¼Œç›´æ¥å¯¹ç±»åˆ«è¿›è¡Œç¼–ç ã€‚è¿™æ˜¯ä¸€ä¸ªç®€å•çš„èµ·ç‚¹ï¼Œä½†æ˜¯ä½¿ç”¨ `StratifiedKFold` ä¸ºåç»­åŸ‹ä¸‹äº†ä¼ç¬”ã€‚</p>
<div class="ug-code-block">
<pre><code class="language-python">
# Baseline ç‰¹å¾å·¥ç¨‹: å¯¹æ‰€æœ‰ç±»åˆ«ç‰¹å¾ï¼ˆåŒ…æ‹¬udmapï¼‰è¿›è¡Œç®€å•çš„æ•´æ•°ç¼–ç 
cat_features = [
    'device_brand', 'ntt', 'operator', 'common_country',
    'common_province', 'common_city', 'appver', 'channel',
    'os_type', 'udmap' # ç›´æ¥å¯¹udmapå­—ç¬¦ä¸²ç¼–ç ï¼Œä¸¢å¤±å†…éƒ¨ä¿¡æ¯
]

for feature in cat_features:
    le = LabelEncoder()
    # ...fit_transform...

# Baseline éªŒè¯æ–¹æ³•: ä½¿ç”¨ StratifiedKFold
kf = StratifiedKFold(n_splits=5, shuffle=True, random_state=42)
</code></pre>
</div>

<h2 id="s3-surprise">â€œæ„å¤–â€çš„æƒŠå–œ</h2>
<div class="ug-grid-2">
    <div>
        <h3 id="s3-my-features" style="font-size: 1.5em; font-weight: 600; margin-bottom: 1rem;">ç‰¹å¾å·¥ç¨‹æ¢ç´¢</h3>
        <p>æˆ‘çš„å·¥ä½œä¸»è¦é›†ä¸­åœ¨ä¸¤ä¸ªæ–¹é¢ï¼š</p>
        <ul style="list-style: disc; padding-left: 20px; margin-top: 1rem;">
            <li>è§£æäº†å¤æ‚çš„`udmap`å­—æ®µï¼Œæå–ç»“æ„åŒ–ä¿¡æ¯ã€‚</li>
            <li style="font-weight: 600;">æœ€é‡è¦åœ°ï¼Œæ„å»ºäº†å¤§é‡çš„ç”¨æˆ·çº§åˆ«èšåˆç‰¹å¾ã€‚</li>
        </ul>
        <div class="ug-code-block">
<pre><code class="language-python">
# æŒ‰ç”¨æˆ·IDåˆ†ç»„ï¼Œç»Ÿè®¡å…¶ç´¯ç§¯è¡Œä¸º
aggregations = {
    'mid': ['count', 'nunique'],
    'common_ts': ['min', 'max'],
    'hour': ['mean', 'std'],
}
did_agg_df = full_df.groupby('did').agg(aggregations)
</code></pre>
        </div>
    </div>
    <div class="ug-info-card ug-center-text">
        <h3 id="s3-results" style="font-size: 1.5em; font-weight: 600; margin-bottom: 1rem;">æ•ˆæœæ‹”ç¾¤ï¼</h3>
        <div class="ug-score-box ug-score-box-green">
            <p class="ug-score-title">æœ¬åœ°éªŒè¯ (StratifiedKFold, F1-Score)</p>
            <p class="ug-score-number ug-text-green">0.902</p>
        </div>
        <div class="ug-score-box ug-score-box-blue">
            <p class="ug-score-title">çº¿ä¸ŠAæ¦œæäº¤</p>
            <p class="ug-score-number ug-text-blue">0.905</p>
        </div>
        <p style="margin-top: 1.5rem; color: var(--text-medium);">éš¾é“è¯´ï¼Ÿ</p>
    </div>
</div>

<h2 id="s4-investigation">æ•²å“è­¦é’Ÿï¼šæ•°æ®é›†çš„â€œCTæ‰«æâ€æŠ¥å‘Š</h2>
<p>ä»¥æˆ‘çš„æ°´å¹³ï¼Œä¸Šåˆ†å²‚æ˜¯å¦‚æ­¤å®¹æ˜“ä¹‹äº‹ï¼Ÿæ‹œæ‰˜Dpskæ¥å†™ä¸€ä¸ªè¯Šæ–­è„šæœ¬ï¼Œç»™æ•°æ®é›†åšä¸€æ¬¡å½»åº•çš„æ£€æŸ¥ã€‚</p>
<div class="ug-info-card">
    <div class="ug-grid-2">
        <div>
            <h3 id="s4-analysis" class="ug-text-blue" style="font-size: 1.5em; font-weight: bold; border-bottom: 2px solid; padding-bottom: 0.5rem; margin-bottom: 1rem;">ğŸ“Š æ•°æ®åˆ†å¸ƒåˆ†æ</h3>
            <p>è®­ç»ƒé›†DIDæ•°: <span style="font-family: monospace;">270,837</span></p>
            <p>æµ‹è¯•é›†DIDæ•°: <span style="font-family: monospace;">206,342</span></p>
            <p class="ug-text-red" style="font-size: 1.2em; font-weight: 600; margin-top: 0.5rem;">é‡å DIDæ•°é‡: <span style="font-family: monospace;">192,393</span> (é«˜è¾¾ <span style="font-family: monospace;">93.24%</span>)</p>
            <h4 style="font-weight: 600; font-size: 1.1em; margin-top: 1rem;">â±ï¸ æ—¶é—´èŒƒå›´</h4>
            <p>è®­ç»ƒé›†: <span style="font-family: monospace;">2025-02-28</span> è‡³ <span style="font-family: monospace;">2025-03-31</span></p>
            <p>æµ‹è¯•é›†: <span style="font-family: monospace;">2025-02-28</span> è‡³ <span style="font-family: monospace;">2025-03-31</span> <span class="ug-text-yellow" style="font-weight: bold;">(å®Œå…¨é‡å !)</span></p>
        </div>
        <div style="border-left: 2px solid var(--border-color); padding-left: 2rem;">
            <h3 id="s4-conclusion" class="ug-text-green" style="font-size: 1.5em; font-weight: bold; border-bottom: 2px solid; padding-bottom: 0.5rem; margin-bottom: 1rem;">ğŸ”§ ç»“æœè§£è¯»</h3>
            <ul style="list-style: disc; padding-left: 20px; space-y-2;">
                <li>æµ‹è¯•é›†ä¸­ç»å¤§éƒ¨åˆ†ç”¨æˆ·åœ¨è®­ç»ƒé›†ä¸­éƒ½æœ‰è¡Œä¸ºè®°å½•ã€‚</li>
                <li>è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„åˆ’åˆ†ä¸æ˜¯æŒ‰â€œè¿‡å»â€å’Œâ€œæœªæ¥â€åˆ’åˆ†çš„ã€‚</li>
                <li class="ug-text-green" style="font-weight: 600;">ä»»ä½•èƒ½åŒºåˆ†â€œè®­ç»ƒé›†å‡ºç°è¿‡â€çš„ç‰¹å¾ï¼Œéƒ½ä¼šæˆä¸ºä½œå¼Šæ·å¾„ã€‚</li>
                <li class="ug-text-green" style="font-weight: 600;">å’‹åŠï¼Ÿå¿…é¡»æ”¹ç”¨åŸºäºåˆ†ç»„çš„äº¤å‰éªŒè¯ã€‚</li>
            </ul>
        </div>
    </div>
</div>
<p style="margin-top: 1rem; font-size: 1.2em; font-weight: 600; text-align: center;">é—®é¢˜çš„æ ¹æºæ˜¯è´¯ç©¿Aæ¦œçš„ç³»ç»Ÿæ€§é—®é¢˜â€”â€”<span class="ug-text-blue">æ•°æ®æ³„éœ²</span>ã€‚</p>

<h2 id="s5-leakage-explained">ä¸»é¢˜èšç„¦ï¼šæœ¬èµ›é¢˜ä¸­çš„â€œæ•°æ®æ³„éœ²â€</h2>
<div class="ug-grid-2">
    <div class="ug-info-card">
        <h3 id="s5-fold-leak" class="ug-text-blue" style="font-size: 1.5em; font-weight: 600; margin-bottom: 1rem;">1. éªŒè¯é›†æ±¡æŸ“</h3>
        <p>ç†æƒ³çš„éªŒè¯é›†åº”è¯¥å……æ»¡â€œé™Œç”Ÿäººâ€ã€‚ä½† `StratifiedKFold` åƒæ´—ç‰Œä¸€æ ·ï¼ŒæŠŠåŒä¸€ä¸ªç”¨æˆ·çš„è®°å½•åˆ‡åˆ†åˆ°äº†è®­ç»ƒå’ŒéªŒè¯é›†é‡Œã€‚æ¨¡å‹åœ¨è®­ç»ƒæ—¶â€œå·çœ‹â€äº†éªŒè¯é›†ç”¨æˆ·çš„éƒ¨åˆ†è¡Œä¸ºï¼Œæ±¡æŸ“äº†è€ƒå·çš„çº¯æ´æ€§ã€‚</p>
    </div>
    <div class="ug-info-card">
        <h3 id="s5-target-leak" class="ug-text-blue" style="font-size: 1.5em; font-weight: 600; margin-bottom: 1rem;">2. ç›®æ ‡æ³„éœ²</h3>
        <p>åšèšåˆç‰¹å¾ï¼ˆæ¯”å¦‚ï¼Œâ€œç”¨æˆ·è¡Œä¸ºæ€»æ¬¡æ•°â€ï¼‰æ—¶ï¼Œè®¡ç®—æ¨ªè·¨äº†æ•´ä¸ªæ•°æ®é›†ã€‚è¿™å¯¼è‡´æœ¬åº”å±äºâ€œæœªæ¥â€çš„ä¿¡æ¯ï¼Œæ³„éœ²ç»™äº†â€œå½“ä¸‹â€ï¼Œç›´æ¥å‘Šè¯‰äº†æ¨¡å‹â€œè¿™ä¸ªç”¨æˆ·ä¸æ˜¯æ–°äººâ€ã€‚</p>
    </div>
</div>

<h2 id="s6-open-book-exam">ä¸€è¨€ä»¥è”½ä¹‹ï¼šä¸€åœºå¿ƒç…§ä¸å®£çš„â€œå¼€å·è€ƒè¯•â€</h2>
<p>æˆ‘çš„0.9åˆ†å¹¶éæ¥è‡ªæ¨¡å‹çš„æ™ºæ…§ï¼Œè€Œæ˜¯å®ƒå¯¹è¿™ç§æ³„éœ²è§„åˆ™çš„ <span class="ug-text-red" style="font-weight: bold; font-size: 1.5em;">æœºæ¢°è®°å¿†</span>ã€‚</p>
<div class="ug-grid-2">
    <div class="ug-code-block">
        <h4 style="font-weight: bold; margin-bottom: 1em;">â€œä½œå¼Šâ€çš„éªŒè¯æ–¹æ³• (StratifiedKFold)</h4>
<pre><code class="language-python">
# å®ƒä¼šå°†åŒä¸€ä¸ªdidçš„è¡Œä¸ºæ‰“æ•£åˆ°è®­ç»ƒå’ŒéªŒè¯é›†
for train_idx, val_idx in kf.split(X, y):
    # æ¨¡å‹åœ¨è®­ç»ƒæ—¶çœ‹åˆ°äº†did=Açš„éƒ¨åˆ†è¡Œä¸º
    # ç„¶ååœ¨éªŒè¯æ—¶åˆçœ‹åˆ°äº†did=Açš„å‰©ä½™è¡Œä¸º
    # èšåˆç‰¹å¾(å¦‚count)ç›´æ¥æ³„éœ²äº†ç­”æ¡ˆ
    ...
</code></pre>
    </div>
    <div class="ug-code-block" style="border-color: var(--success-green);">
        <h4 style="font-weight: bold; margin-bottom: 1em;">â€œè¯šå®â€çš„éªŒè¯æ–¹æ³• (GroupKFold)</h4>
<pre><code class="language-python">
# ä¿è¯åŒä¸€ä¸ªdidçš„æ‰€æœ‰è¡Œä¸ºè¦ä¹ˆéƒ½åœ¨è®­ç»ƒé›†ï¼Œ
# è¦ä¹ˆéƒ½åœ¨éªŒè¯é›†
from sklearn.model_selection import GroupKFold

kf = GroupKFold(n_splits=5)

# ä¼ å…¥groupså‚æ•°ï¼ŒæŒ‰didè¿›è¡Œåˆ†ç»„
for train_idx, val_idx in kf.split(X, y, groups=did_groups):
    # éªŒè¯é›†é‡Œçš„didæ˜¯æ¨¡å‹å®Œå…¨æ²¡è§è¿‡çš„
    # è€ƒéªŒçš„æ˜¯æ¨¡å‹çš„çœŸå®æ³›åŒ–èƒ½åŠ›
    ...
</code></pre>
    </div>
</div>

<h2 id="s7-b-list-strategy">çŒœæµ‹ï¼šAæ¦œçš„â€œé™·é˜±â€ä¸Bæ¦œçš„å¯¹ç­–</h2>
<p>è¿™æ˜¯ä¸€ä¸ªç»å…¸çš„ç«èµ›æ¨¡å¼ï¼šAæ¦œæ˜¯ä¾›å¤§å®¶æ¢ç´¢çš„æ¨¡æ‹Ÿåœºï¼Œè€ŒBæ¦œæ‰æ˜¯ä¸€é”¤å®šéŸ³çš„çœŸå®è€ƒåœºã€‚æˆ˜ç•¥ç›®æ ‡ä¸åº”æ˜¯æœ€å¤§åŒ–Aæ¦œåˆ†æ•°ï¼Œè€Œæ˜¯æ„å»ºä¸€ä¸ªèƒ½åœ¨ <span class="ug-text-blue" style="font-weight: bold;">Bæ¦œ</span> ä¸Šç”Ÿå­˜çš„ç¨³å¥æ¨¡å‹ã€‚</p>

<h2 id="s8-honest-score">ä¸ºBæ¦œè€Œæˆ˜ï¼šæ‹¥æŠ±â€œè¯šå®â€çš„åˆ†æ•°</h2>
<p>æ¢ç”¨èƒ½ä¿è¯â€œé—­å·è€ƒè¯•â€çš„`GroupKFold`åï¼Œåˆ†æ•°è¢«æ‰“å›åŸå½¢â€”â€”è™½ç„¶å›è½ï¼Œä½†å®ƒå¾ˆ <span class="ug-text-green" style="font-weight: bold;">â€œè¯šå®â€</span>ã€‚å®ƒä»£è¡¨äº†æ¨¡å‹åœ¨é¢å¯¹æœªçŸ¥ç”¨æˆ·æ—¶çš„çœŸå®èƒ½åŠ›ï¼Œæ˜¯ç»§ç»­ä¼˜åŒ–çš„åšå®åœ°åŸºã€‚</p>
<div class="ug-center-text" style="margin-top: 2rem;">
    <p style="color: var(--text-medium);">æ‰“å›åŸå½¢çš„F1-Score</p>
    <p style="font-size: 5rem; font-weight: 800; margin: 1rem 0;" class="ug-text-red">0.67</p>
</div>

<h2 id="s9-future-plan">ä¸‹ä¸€æ­¥å¤‡æˆ˜ç­–ç•¥ï¼šæ·±åº¦æ—¶åºæ¨¡å‹</h2>
<p>ä»â€œæ‰‹åŠ¨â€ç†è§£æ—¶åºåˆ°è®©æ¨¡å‹â€œè‡ªåŠ¨â€å­¦ä¹ åºåˆ—æ¨¡å¼ã€‚</p>
<div class="ug-grid-2">
    <div class="ug-info-card" style="border-color: var(--primary-accent);">
        <h3 id="s9-end-to-end" class="ug-text-purple" style="font-size: 1.5em; font-weight: 600; margin-bottom: 1rem;">ç­–ç•¥ä¸€ï¼šç«¯åˆ°ç«¯æ—¶åºæ¨¡å‹</h3>
        <p>ç›´æ¥ç”¨ä¸€ä¸ªæ·±åº¦å­¦ä¹ æ¨¡å‹ï¼ˆå¦‚LSTMæˆ–Transformerï¼‰æ¥ç«¯åˆ°ç«¯åœ°å®Œæˆé¢„æµ‹ä»»åŠ¡ã€‚æ¨¡å‹å°†è‡ªåŠ¨å­¦ä¹ æ•´ä¸ªç”¨æˆ·è¡Œä¸ºåºåˆ—ä¸­çš„å¤æ‚æ¨¡å¼ã€‚</p>
    </div>
    <div class="ug-info-card" style="border-color: var(--primary-accent);">
        <h3 id="s9-hybrid-model" class="ug-text-teal" style="font-size: 1.5em; font-weight: 600; margin-bottom: 1rem;">ç­–ç•¥äºŒï¼šæ··åˆæ¨¡å‹ (æ¨è)</h3>
        <p>æ—¶åºæ¨¡å‹ä½œä¸ºç‰¹å¾æå–å™¨ã€‚ç”¨å®ƒâ€œé˜…è¯»â€ç”¨æˆ·è¡Œä¸ºåºåˆ—ï¼Œç”Ÿæˆæ·±åº¦ç‰¹å¾ï¼Œå†ä¸æ‰‹åŠ¨è®¾è®¡çš„èšåˆç‰¹å¾æ‹¼æ¥ï¼Œæœ€åå–‚ç»™LightGBMåšåˆ†ç±»ï¼Œå…¼é¡¾è§£é‡Šæ€§ä¸æ•ˆæœã€‚</p>
    </div>
</div>

<h2 id="s10-conclusion">ç»“è¯­ï¼šä¿æŒæ€€ç–‘</h2>
<p class="ug-center-text" style="font-size: 1.2em; color: var(--text-medium);">åˆå‡ºèŒ…åºï¼Œå¯¹â€œè¿‡äºç¾å¥½â€çš„åˆ†æ•°ä¿æŒä¸€ä»½æ€€ç–‘ï¼Œæ˜¯æ•°æ®ç§‘å­¦è·¯ä¸Šéå¸¸å®è´µçš„ä¸€è¯¾ã€‚</p>
